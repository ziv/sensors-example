import{Ja as O,Ka as F,La as E,Na as M,Oa as _,Ta as i,U as f,Ua as n,V as u,Va as h,Wa as C,Ya as x,Za as m,a as P,aa as c,bb as v,cb as g,db as S,eb as o,fb as p,gb as l,hb as w,na as r,xa as y}from"./chunk-DEVMJMW7.js";function D(d,e){d&1&&(i(0,"div",1)(1,"p"),o(2,"\u26A0\uFE0F Magnetometer is not supported on this device"),n(),i(3,"small"),o(4,"This sensor requires specific hardware and browser support"),n()())}function I(d,e){if(d&1){let t=C();i(0,"div",2)(1,"p"),o(2,"This app needs permission to access the magnetometer sensor."),n(),i(3,"button",4),x("click",function(){f(t);let s=m();return u(s.requestPermission())}),o(4," Grant Permission "),n()()}}function T(d,e){if(d&1&&h(0,"div",37),d&2){let t=e.$implicit,a=m(2);v("transform","rotate("+(t+a.magneticField().x*.1)+"deg)")("opacity",a.Math.min(1,a.totalField()/100))}}function H(d,e){if(d&1&&(i(0,"div",31)(1,"span",38),o(2),n(),i(3,"span",39),o(4),n()()),d&2){let t=e.$implicit,a=m(2);r(2),p(a.formatTime(t.timestamp)),r(2),w("",t.change>0?"+":"","",t.change.toFixed(1),"\xB5T")}}function B(d,e){if(d&1){let t=C();i(0,"div",3)(1,"div",5)(2,"div",6)(3,"div",7)(4,"div",8),o(5,"\u{1F9F2}"),n(),i(6,"div",9)(7,"span",10),o(8),n(),i(9,"span",11),o(10,"\xB5T"),n()()(),i(11,"div",12),M(12,T,1,4,"div",13,E),n()(),i(14,"div",14)(15,"div",15),h(16,"div",16),n()()(),i(17,"div",17)(18,"div",18)(19,"label"),o(20,"Total Field:"),n(),i(21,"span",19),o(22),n()(),i(23,"div",20)(24,"label"),o(25,"X-Axis:"),n(),i(26,"span"),o(27),n()(),i(28,"div",20)(29,"label"),o(30,"Y-Axis:"),n(),i(31,"span"),o(32),n()(),i(33,"div",20)(34,"label"),o(35,"Z-Axis:"),n(),i(36,"span"),o(37),n()(),i(38,"div",20)(39,"label"),o(40,"Field Strength:"),n(),i(41,"span"),o(42),n()()(),i(43,"div",21)(44,"h3"),o(45,"Magnetic Field Analysis"),n(),i(46,"div",22)(47,"div",23)(48,"div",24),o(49,"Horizontal Component"),n(),i(50,"div",25),o(51),n()(),i(52,"div",23)(53,"div",24),o(54,"Vertical Component"),n(),i(55,"div",25),o(56),n()(),i(57,"div",23)(58,"div",24),o(59,"Magnetic Inclination"),n(),i(60,"div",25),o(61),n()(),i(62,"div",23)(63,"div",24),o(64,"Declination Estimate"),n(),i(65,"div",25),o(66),n()()()(),i(67,"div",26)(68,"h3"),o(69,"Interference Detection"),n(),i(70,"div",27),h(71,"div",28),i(72,"div",29)(73,"strong"),o(74),n(),i(75,"p"),o(76),n()()(),i(77,"div",30)(78,"h4"),o(79,"Recent Changes"),n(),M(80,H,5,3,"div",31,E),n()(),i(82,"div",32)(83,"h3"),o(84,"About Earth's Magnetic Field"),n(),i(85,"div",33)(86,"p"),o(87,"Earth's magnetic field typically ranges from 25-65 \xB5T (microtesla). The field strength varies by location and is affected by:"),n(),i(88,"ul")(89,"li"),o(90,"\u{1F30D} Geographic location (stronger near poles)"),n(),i(91,"li"),o(92,"\u26A1 Electronic devices and metal objects"),n(),i(93,"li"),o(94,"\u{1F3E2} Building materials and structures"),n(),i(95,"li"),o(96,"\u{1F31E} Solar activity and space weather"),n()()()(),i(97,"div",34)(98,"button",35),x("click",function(){f(t);let s=m();return u(s.calibrate())}),o(99," \u{1F3AF} Calibrate "),n(),i(100,"button",36),x("click",function(){f(t);let s=m();return u(s.clearHistory())}),o(101," \u{1F9F9} Clear History "),n()()()}if(d&2){let t=m();r(8),p(t.totalField().toFixed(0)),r(4),_(t.fieldLines),r(3),v("transform","rotate("+t.getCompassAngle()+"deg)"),r(7),l("",t.totalField().toFixed(1)," \xB5T"),r(4),g("strong",t.Math.abs(t.magneticField().x)>30),r(),l(" ",t.magneticField().x.toFixed(1)," \xB5T "),r(4),g("strong",t.Math.abs(t.magneticField().y)>30),r(),l(" ",t.magneticField().y.toFixed(1)," \xB5T "),r(4),g("strong",t.Math.abs(t.magneticField().z)>30),r(),l(" ",t.magneticField().z.toFixed(1)," \xB5T "),r(4),g("strong",t.getFieldStrength().level==="strong"),r(),l(" ",t.getFieldStrength().description," "),r(9),l("",t.getHorizontalComponent().toFixed(1)," \xB5T"),r(5),l("",t.magneticField().z.toFixed(1)," \xB5T"),r(5),l("",t.getMagneticInclination().toFixed(1),"\xB0"),r(5),l("",t.getMagneticDeclination().toFixed(1),"\xB0"),r(4),S(t.getInterferenceLevel().level),r(4),p(t.getInterferenceLevel().title),r(2),p(t.getInterferenceLevel().description),r(4),_(t.fieldHistory().slice(-3))}}var k=class d{supported=c(!1);hasPermission=c(!1);magneticField=c({x:0,y:0,z:0});fieldHistory=c([]);fieldLines=Array.from({length:8},(e,t)=>t*45);Math=Math;sensor=null;calibrationOffset={x:0,y:0,z:0};lastFieldReading=0;ngOnInit(){this.checkSupport()}ngOnDestroy(){this.stopSensor()}checkSupport(){"Magnetometer"in window?(this.supported.set(!0),this.requestPermission()):this.simulateMagnetometer()}async requestPermission(){try{let e=await navigator.permissions.query({name:"magnetometer"});(e.state==="granted"||e.state==="prompt")&&(this.hasPermission.set(!0),this.startSensor())}catch(e){console.error("Permission error:",e),this.simulateMagnetometer()}}startSensor(){try{this.sensor=new window.Magnetometer({frequency:10}),this.sensor.addEventListener("reading",()=>{let e={x:this.sensor.x-this.calibrationOffset.x,y:this.sensor.y-this.calibrationOffset.y,z:this.sensor.z-this.calibrationOffset.z};this.updateMagneticField(e)}),this.sensor.addEventListener("error",e=>{console.error("Magnetometer error:",e),this.simulateMagnetometer()}),this.sensor.start()}catch(e){console.error("Failed to start magnetometer:",e),this.simulateMagnetometer()}}stopSensor(){this.sensor&&(this.sensor.stop(),this.sensor=null)}simulateMagnetometer(){this.supported.set(!0),this.hasPermission.set(!0);let e=20,t=5,a=45;setInterval(()=>{let s=Math.sin(Date.now()/5e3)*2,b=(Math.random()-.5)*3,z={x:e+s+b,y:t+(Math.random()-.5)*2,z:a+(Math.random()-.5)*5};this.updateMagneticField(z)},100)}updateMagneticField(e){this.magneticField.set(e);let t=this.calculateTotalField(e),a=t-this.lastFieldReading;if(Math.abs(a)>1){let s=this.fieldHistory();this.fieldHistory.set([...s,{timestamp:Date.now(),field:t,change:a}].slice(-10))}this.lastFieldReading=t}calculateTotalField(e){return Math.sqrt(e.x*e.x+e.y*e.y+e.z*e.z)}totalField(){let e=this.magneticField();return this.calculateTotalField(e)}getHorizontalComponent(){let e=this.magneticField();return Math.sqrt(e.x*e.x+e.y*e.y)}getMagneticInclination(){let e=this.getHorizontalComponent(),t=this.magneticField().z;return Math.atan2(t,e)*(180/Math.PI)}getMagneticDeclination(){let e=this.magneticField();return Math.atan2(e.y,e.x)*(180/Math.PI)}getCompassAngle(){return this.getMagneticDeclination()}getFieldStrength(){let e=this.totalField();return e<20?{level:"weak",description:"Weak Field"}:e<40?{level:"normal",description:"Normal Field"}:e<70?{level:"strong",description:"Strong Field"}:{level:"very-strong",description:"Very Strong"}}getInterferenceLevel(){let e=this.totalField(),a=this.fieldHistory().slice(-3),s=Math.max(...a.map(b=>Math.abs(b.change)),0);return s>10||e>80||e<10?{level:"high",title:"High Interference",description:"Magnetic field is significantly distorted. Move away from metal objects or electronics."}:s>5||e>60||e<25?{level:"medium",title:"Moderate Interference",description:"Some magnetic interference detected. Results may be less accurate."}:{level:"low",title:"Low Interference",description:"Magnetic field readings appear normal and stable."}}formatTime(e){return new Date(e).toLocaleTimeString().split(" ")[0]}calibrate(){let e=this.magneticField();this.calibrationOffset=P({},e),this.magneticField.set({x:0,y:0,z:0})}clearHistory(){this.fieldHistory.set([])}static \u0275fac=function(t){return new(t||d)};static \u0275cmp=y({type:d,selectors:[["app-magnetometer"]],decls:6,vars:1,consts:[[1,"magnetometer"],[1,"error"],[1,"permission-request"],[1,"sensor-container"],[1,"permission-btn",3,"click"],[1,"magnetic-field-display"],[1,"field-visualization"],[1,"field-center"],[1,"magnet-icon"],[1,"field-strength"],[1,"strength-value"],[1,"strength-unit"],[1,"field-lines"],[1,"field-line",3,"transform","opacity"],[1,"field-compass"],[1,"compass-needle"],[1,"needle-tip"],[1,"readings"],[1,"reading","primary"],[1,"field-value"],[1,"reading"],[1,"field-analysis"],[1,"analysis-grid"],[1,"analysis-item"],[1,"analysis-label"],[1,"analysis-value"],[1,"interference-detector"],[1,"interference-status"],[1,"status-indicator"],[1,"status-text"],[1,"interference-history"],[1,"field-change"],[1,"magnetic-info"],[1,"info-content"],[1,"controls"],[1,"calibrate-btn",3,"click"],[1,"clear-btn",3,"click"],[1,"field-line"],[1,"change-time"],[1,"change-value"]],template:function(t,a){t&1&&(i(0,"div",0)(1,"h1"),o(2,"\u{1F9F2} Magnetometer"),n(),O(3,D,5,0,"div",1)(4,I,5,0,"div",2)(5,B,102,24,"div",3),n()),t&2&&(r(3),F(a.supported()?a.hasPermission()?5:4:3))},styles:[".magnetometer[_ngcontent-%COMP%]{max-width:800px;margin:0 auto;padding:2rem}h1[_ngcontent-%COMP%]{color:#333;margin-bottom:2rem;text-align:center}.error[_ngcontent-%COMP%], .permission-request[_ngcontent-%COMP%]{background:#f8d7da;color:#721c24;padding:2rem;border-radius:1rem;margin:2rem 0;text-align:center}.permission-btn[_ngcontent-%COMP%]{background:#007bff;color:#fff;border:none;padding:1rem 2rem;border-radius:.5rem;font-size:1rem;cursor:pointer;margin-top:1rem}.sensor-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2rem}.magnetic-field-display[_ngcontent-%COMP%]{background:#fff;border-radius:1rem;padding:2rem;box-shadow:0 4px 20px #0000001a;display:grid;grid-template-columns:1fr 1fr;gap:2rem}.field-visualization[_ngcontent-%COMP%]{position:relative;height:250px;background:radial-gradient(circle,#e3f2fd,#bbdefb);border-radius:1rem;overflow:hidden}.field-center[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);text-align:center;z-index:10}.magnet-icon[_ngcontent-%COMP%]{font-size:3rem;margin-bottom:.5rem;filter:drop-shadow(0 0 10px rgba(220,53,69,.5))}.field-strength[_ngcontent-%COMP%]{background:#fff;padding:.5rem;border-radius:.5rem;box-shadow:0 2px 10px #0000001a}.strength-value[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;color:#dc3545}.strength-unit[_ngcontent-%COMP%]{font-size:.9rem;color:#666}.field-lines[_ngcontent-%COMP%]{position:absolute;inset:0}.field-line[_ngcontent-%COMP%]{position:absolute;width:2px;height:100px;background:linear-gradient(to bottom,#dc3545,transparent);top:50%;left:50%;transform-origin:50% 0%;transition:transform .3s ease,opacity .3s ease}.field-compass[_ngcontent-%COMP%]{position:relative;height:250px;background:#f8f9fa;border-radius:1rem;border:3px solid #333}.compass-needle[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;width:4px;height:80px;background:linear-gradient(to top,#333,#dc3545);transform-origin:50% 100%;transition:transform .3s ease;margin-left:-2px;margin-top:-80px}.needle-tip[_ngcontent-%COMP%]{position:absolute;top:0;left:50%;transform:translate(-50%);width:0;height:0;border-left:6px solid transparent;border-right:6px solid transparent;border-bottom:20px solid #dc3545}.readings[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1rem}.reading[_ngcontent-%COMP%]{background:#fff;padding:1rem;border-radius:.5rem;box-shadow:0 2px 10px #0000001a;display:flex;justify-content:space-between;align-items:center}.reading.primary[_ngcontent-%COMP%]{grid-column:1 / -1;background:linear-gradient(135deg,#dc3545,#c82333);color:#fff}.reading[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:700}.reading[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:700}.field-value[_ngcontent-%COMP%]{font-size:1.5rem!important}.reading[_ngcontent-%COMP%]   span.strong[_ngcontent-%COMP%]{color:#dc3545}.reading.primary[_ngcontent-%COMP%]   span.strong[_ngcontent-%COMP%]{color:#fff;text-shadow:0 0 10px rgba(255,255,255,.5)}.field-analysis[_ngcontent-%COMP%], .interference-detector[_ngcontent-%COMP%], .magnetic-info[_ngcontent-%COMP%]{background:#fff;border-radius:1rem;padding:2rem;box-shadow:0 4px 20px #0000001a}.field-analysis[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .interference-detector[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .magnetic-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#333;margin-bottom:1rem}.analysis-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1rem}.analysis-item[_ngcontent-%COMP%]{background:#f8f9fa;padding:1rem;border-radius:.5rem;text-align:center}.analysis-label[_ngcontent-%COMP%]{font-size:.9rem;color:#666;margin-bottom:.5rem}.analysis-value[_ngcontent-%COMP%]{font-size:1.2rem;font-weight:700;color:#333}.interference-status[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;padding:1rem;border-radius:.5rem;margin-bottom:1rem}.interference-status.low[_ngcontent-%COMP%]{background:#d4edda;border-left:4px solid #28a745}.interference-status.medium[_ngcontent-%COMP%]{background:#fff3cd;border-left:4px solid #ffc107}.interference-status.high[_ngcontent-%COMP%]{background:#f8d7da;border-left:4px solid #dc3545}.status-indicator[_ngcontent-%COMP%]{width:20px;height:20px;border-radius:50%}.interference-status.low[_ngcontent-%COMP%]   .status-indicator[_ngcontent-%COMP%]{background:#28a745}.interference-status.medium[_ngcontent-%COMP%]   .status-indicator[_ngcontent-%COMP%]{background:#ffc107}.interference-status.high[_ngcontent-%COMP%]   .status-indicator[_ngcontent-%COMP%]{background:#dc3545}.status-text[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{display:block;margin-bottom:.25rem}.status-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:.9rem}.interference-history[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:#333;margin-bottom:.5rem;font-size:1rem}.field-change[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:.5rem;background:#f8f9fa;border-radius:.25rem;margin-bottom:.25rem}.change-time[_ngcontent-%COMP%]{font-size:.8rem;color:#666}.change-value[_ngcontent-%COMP%]{font-weight:700;color:#333}.magnetic-info[_ngcontent-%COMP%]   .info-content[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin:1rem 0;padding-left:1.5rem}.magnetic-info[_ngcontent-%COMP%]   .info-content[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:.5rem;color:#666}.controls[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:1rem}.calibrate-btn[_ngcontent-%COMP%], .clear-btn[_ngcontent-%COMP%]{padding:1rem 2rem;border-radius:.5rem;font-size:1rem;cursor:pointer;border:none}.calibrate-btn[_ngcontent-%COMP%]{background:#17a2b8;color:#fff}.calibrate-btn[_ngcontent-%COMP%]:hover{background:#138496}.clear-btn[_ngcontent-%COMP%]{background:#6c757d;color:#fff}.clear-btn[_ngcontent-%COMP%]:hover{background:#545b62}@media (max-width: 768px){.magnetometer[_ngcontent-%COMP%]{padding:1rem}.magnetic-field-display[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:1rem}.field-visualization[_ngcontent-%COMP%], .field-compass[_ngcontent-%COMP%]{height:200px}.readings[_ngcontent-%COMP%]{grid-template-columns:1fr}.analysis-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}.controls[_ngcontent-%COMP%]{flex-direction:column;align-items:center}}"]})};export{k as MagnetometerComponent};
